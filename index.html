

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üß† SYNDICATE v18.1 ML/AI - HIGH SCORE FIXED</title>
  <style>
    :root{--primary:#00d4aa;--secondary:#ffd700;--ml-purple:#9c66ff;--danger:#ff6b7a;--success:#4caf50;--bg-dark:#0f0f23;--bg-card:rgba(255,255,255,0.06);}
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:system-ui,sans-serif;background:linear-gradient(135deg,var(--bg-dark),#1a1a2e);color:#fff;min-height:100vh;}
    
    .top-notification{position:fixed;top:0;left:0;right:0;background:rgba(0,0,0,0.98);backdrop-filter:blur(30px);z-index:2000;max-height:400px;overflow-y:auto;border-bottom:3px solid var(--secondary);}
    .notification-header{padding:15px 20px;background:linear-gradient(90deg,var(--secondary),var(--ml-purple));text-align:center;font-weight:900;font-size:16px;}
    .notification-item{padding:18px 25px;border-bottom:1px solid rgba(255,215,0,0.3);display:flex;flex-wrap:wrap;gap:15px;align-items:flex-start;}
    .notification-item.new{animation:super-blink 0.8s infinite alternate;box-shadow:0 0 30px rgba(255,215,0,0.6);}
    @keyframes super-blink{0%{background:rgba(255,215,0,0.2);}100%{background:rgba(255,165,0,0.4);transform:scale(1.03);}}
    .notif-dot{width:16px;height:16px;background:var(--secondary);border-radius:50%;animation:pulse 0.8s infinite;margin-right:15px;flex-shrink:0;}
    .notif-main{flex:1;min-width:300px;}
    .notif-league{font-size:16px;font-weight:900;color:var(--secondary);margin-bottom:5px;}
    .notif-teams{font-size:14px;font-weight:700;}
    .notif-prediction{font-size:18px;font-weight:900;color:var(--secondary);margin:8px 0;}
    .notif-odds{display:flex;flex-wrap:wrap;gap:20px;font-size:13px;}
    .odds-item{padding:8px 12px;background:rgba(255,255,255,0.1);border-radius:12px;border:1px solid rgba(255,215,0,0.3);}
    
    .main-content{padding-top:420px;}
    .container{max-width:1600px;margin:0 auto;padding:20px;}
    .header{text-align:center;padding:40px 20px;background:linear-gradient(135deg,var(--ml-purple),rgba(156,102,255,0.4));border-radius:25px;margin-bottom:20px;border:2px solid var(--ml-purple);}
    .header h1{font-size:clamp(2em,5vw,3.5em);background:linear-gradient(45deg,var(--primary),var(--secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
    
    .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:20px;margin:20px 0;}
    .stat-card{background:var(--bg-card);backdrop-filter:blur(20px);padding:20px;border-radius:20px;text-align:center;border:1px solid rgba(255,255,255,0.1);}
    .stat-value{font-size:clamp(1.8em,3vw,2.8em);font-weight:900;color:var(--secondary);}
    
    .matches{max-height:65vh;overflow-y:auto;padding:20px;gap:15px;display:grid;}
    .match{background:var(--bg-card);backdrop-filter:blur(25px);padding:25px;border-radius:20px;border:2px solid rgba(255,255,255,0.1);}
    .match-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;}
    .league{font-size:1.3em;font-weight:900;color:var(--primary);}
    .ai-badge{padding:10px 18px;border-radius:25px;font-weight:900;font-size:13px;background:linear-gradient(45deg,var(--secondary),#ffed4a);color:#000;}
    
    .score-board{display:grid;grid-template-columns:1fr auto 1fr;gap:20px;align-items:center;margin:20px 0;}
    .team-name{font-size:1.3em;font-weight:900;}
    .live-score{font-size:3em;font-weight:900;color:var(--secondary);text-shadow:0 0 20px var(--secondary);}
    
    .team-odds{display:flex;justify-content:space-around;padding:20px;background:linear-gradient(135deg,rgba(0,212,170,0.2),rgba(156,102,255,0.2));border-radius:20px;margin:15px 0;border:2px solid rgba(255,215,0,0.3);}
    .odds-box{text-align:center;}
    .odds-label{font-size:12px;text-transform:uppercase;opacity:0.9;margin-bottom:8px;font-weight:700;}
    .odds-value{font-size:2.5em;font-weight:900;color:var(--secondary);text-shadow:0 0 15px var(--secondary);}
    
    .markets-title{font-size:1.2em;font-weight:900;color:var(--secondary);margin:20px 0 10px 0;text-align:center;}
    .main-markets-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:10px;}
    .market-card{padding:18px 8px;background:rgba(255,255,255,0.08);border-radius:15px;text-align:center;font-weight:900;border:2px solid transparent;transition:all 0.3s;cursor:pointer;}
    .market-card:hover{transform:scale(1.05);}
    .market-card.high{animation:pulse-gold 1.5s infinite;border-color:var(--secondary);background:rgba(255,215,0,0.3);}
    .market-card.removed{background:rgba(50,50,50,0.5);color:#666;border-color:#444;}
    .market-value{font-size:1.8em;color:var(--secondary);}
    .market-label{font-size:11px;text-transform:uppercase;margin-top:2px;}
    
    .status-bar{padding:12px;background:linear-gradient(90deg,rgba(156,102,255,0.2),rgba(0,212,170,0.2));border-radius:15px;font-size:1em;font-weight:700;margin:15px 0;display:flex;flex-wrap:wrap;gap:10px;}
    
    .api-status{position:fixed;top:20px;right:20px;background:rgba(0,0,0,0.9);backdrop-filter:blur(25px);padding:20px;border-radius:20px;border:2px solid var(--ml-purple);font-size:14px;z-index:1500;max-width:320px;}
    @keyframes pulse-gold{0%,100%{box-shadow:0 0 20px rgba(255,215,0,0.5);}50%{box-shadow:0 0 40px rgba(255,215,0,0.9);}}
    @keyframes pulse{0%,100%{transform:scale(1);}50%{transform:scale(1.1);}}
  </style>
</head>
<body>
  <div class="api-status" id="apiStatus">üîÑ v18.1 HIGH SCORE FIXED Loading...</div>
  
  <div class="top-notification" id="topNotifications">
    <div class="notification-header">üö® TOP ML/AI NOTIFICATIONS (‚â•70%) - MAX 25</div>
  </div>
  
  <main class="main-content">
    <div class="container">
      <header class="header">
        <h1>üß† SYNDICATE v18.1 ML/AI</h1>
        <p>HIGH SCORE FIXED | 3-1=85% | MAIN MARKETS 0.5/1.5/2.5/3.5/4.5/5.5 | TOP NOTIFS | üáµüá∞ PKT</p>
      </header>

      <section class="stats-grid" id="statsGrid"></section>
      
      <section class="matches" id="matchesContainer">
        <div style="text-align:center;font-size:1.5em;padding:100px;color:var(--primary);">üß† v18.1 High Score Logic Fixed - Loading Live Matches...</div>
      </section>
    </div>
  </main>

  <script>
    let notificationsData = [], matchesData = [];
    const MAIN_MARKETS = ['O0.5', 'O1.5', 'O2.5', 'O3.5', 'O4.5', 'O5.5'];
    
    function updateStats(data) {
      const statsGrid = document.getElementById('statsGrid');
      const pktSec = Math.round((Date.now() / 1000) % 60);
      statsGrid.innerHTML = `
        <div class="stat-card"><div class="stat-value">${data.notifications?.length || 0}</div><div class="stat-label">TOP ALERTS</div></div>
        <div class="stat-card"><div class="stat-value">${data.live_count || 0}</div><div class="stat-label">LIVE MATCHES</div></div>
        <div class="stat-card"><div class="stat-value">${data.total_scanned || 0}</div><div class="stat-label">SCANNED</div></div>
        <div class="stat-card"><div class="stat-value">${pktSec}</div><div class="stat-label">PKT SEC</div></div>
        <div class="stat-card"><div class="stat-value">v18.1</div><div class="stat-label">FIXED</div></div>
      `;
    }
    
    function renderTopNotifications(notifications) {
      const topBar = document.getElementById('topNotifications');
      if (!notifications?.length) {
        topBar.innerHTML = `
          <div class="notification-header">üö® TOP ML/AI NOTIFICATIONS (‚â•70%) - MAX 25</div>
          <div style="padding:30px;text-align:center;color:#888;">No new alerts (‚â•70% confidence)</div>
        `;
        return;
      }
      
      topBar.innerHTML = `
        <div class="notification-header">üö® TOP ML/AI NOTIFICATIONS (${notifications.length}/25)</div>
        ${notifications.map(notif => `
          <div class="notification-item ${notif.isNew ? 'new' : ''}">
            <div class="notif-dot"></div>
            <div class="notif-main">
              <div class="notif-league">${notif.league}</div>
              <div class="notif-teams">${notif.teams} (${notif.score}) ${notif.minute}'</div>
              <div class="notif-prediction">üî• ${notif.bestMarket} ${notif.bestConf}%</div>
              <div class="notif-odds">
                <div class="odds-item">üè† ${notif.homeWin}%</div>
                <div class="odds-item">‚úàÔ∏è ${notif.awayWin}%</div>
                <div class="odds-item">ü§ù ${notif.drawChance}%</div>
              </div>
            </div>
          </div>
        `).join('')}
      `;
    }
    
    function renderMatches(matches) {
      const container = document.getElementById('matchesContainer');
      
      if (!matches?.length) {
        container.innerHTML = '<div style="text-align:center;font-size:1.5em;padding:100px;color:var(--primary);">No live matches ‚â•70%<br>üß† High score logic active - scanning SofaScore...</div>';
        return;
      }
      
      container.innerHTML = matches.map(match => {
        const analysis = match.analysis;
        const totalGoals = match.home_score + match.away_score;
        const dynamic = analysis.dynamicWinDraw;
        
        return `
          <div class="match" data-match="${match.id}">
            <div class="match-header">
              <div class="league">${match.league}</div>
              <span class="ai-badge">AI ${Math.round(analysis.ai_confidence)}%</span>
            </div>
            
            <div class="score-board">
              <div class="team-name">${match.home_team}</div>
              <div class="live-score">${match.home_score}-${match.away_score}</div>
              <div class="team-name">${match.away_team}</div>
            </div>
            
            <div class="status-bar">
              LIVE ${match.minute}' | üáµüá∞ ${match.pk_time} | Œª${analysis.totalLambda}
            </div>
            
            <div class="team-odds">
              <div class="odds-box">
                <div class="odds-label">HOME WIN</div>
                <div class="odds-value">${dynamic.homeWin}%</div>
              </div>
              <div class="odds-box">
                <div class="odds-label">DRAW</div>
                <div class="odds-value">${dynamic.draw}%</div>
              </div>
              <div class="odds-box">
                <div class="odds-label">AWAY WIN</div>
                <div class="odds-value">${dynamic.awayWin}%</div>
              </div>
            </div>
            
            <div class="markets-title">üìä MAIN OVER/UNDER (Auto Removed)</div>
            <div class="main-markets-grid">
              ${MAIN_MARKETS.map(market => {
                const conf = analysis.activeMarkets[market];
                const line = parseFloat(market.slice(1));
                const isRemoved = totalGoals >= line;
                
                if (isRemoved) {
                  return `
                    <div class="market-card removed" title="${market} - HIT">
                      <div class="market-value">‚úì</div>
                      <div class="market-label">${market}</div>
                    </div>
                  `;
                }
                
                return conf ? `
                  <div class="market-card ${conf >= 70 ? 'high' : ''}" title="${market} ${conf}%">
                    <div class="market-value">${conf}%</div>
                    <div class="market-label">${market}</div>
                  </div>
                ` : `
                  <div class="market-card" title="${market} - Low">
                    <div class="market-value">--</div>
                    <div class="market-label">${market}</div>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
        `;
      }).join('');
    }
    
    async function loadData() {
      try {
        const apiStatus = document.getElementById('apiStatus');
        apiStatus.textContent = 'üß† v18.1 High Score Fixed - Fetching Live Data...';
        
        const res = await fetch('/api/matches');
        const data = await res.json();
        
        notificationsData = data.notifications || [];
        matchesData = data.live || [];
        
        renderTopNotifications(notificationsData);
        updateStats(data);
        renderMatches(matchesData);
        
        apiStatus.innerHTML = `‚úÖ ${notificationsData.length} TOP | ${matchesData.length} LIVE | üáµüá∞ ${data.pkt_time} | v18.1 FIXED`;
      } catch(e) {
        document.getElementById('matchesContainer').innerHTML = '<div style="text-align:center;font-size:1.5em;padding:100px;color:#ff6b7a;">‚ùå Server Error<br>1. Save server.js v18.1<br>2. node server.js<br>3. Refresh</div>';
        document.getElementById('apiStatus').textContent = '‚ùå Server Down - node server.js';
      }
    }
    
    // Auto refresh every 7 seconds
    setInterval(loadData, 7000);
    loadData();
  </script>
</body>
</html>
